const display=document.getElementById('display');let expr='';
const buttons=['7','8','9','/','C','4','5','6','*','(','1','2','3','-',')','0','.','=','+','√'];
const btnGrid=document.getElementById('btn-grid');
buttons.forEach(val=>{const b=document.createElement('button');b.innerText=val;b.onclick=()=>{if(val==='C'){expr='';display.value='';}else if(val==='='){try{expr=expr.replace(/√/g,'Math.sqrt');display.value=Function('"use strict";return('+expr+')')();expr=display.value;}catch{display.value='Error';expr='';}}else{expr+=val;display.value=expr;}};if(['+','-','*','/','=','√'].includes(val))b.classList.add('operator');btnGrid.appendChild(b);});
document.querySelectorAll('.tab-button').forEach(b=>b.onclick=()=>{document.querySelectorAll('.tab-button').forEach(x=>x.classList.remove('active'));document.querySelectorAll('.panel').forEach(x=>x.classList.remove('active'));b.classList.add('active');document.getElementById(b.dataset.panel).classList.add('active');});
document.getElementById('calc-bmi').onclick=()=>{const w=parseFloat(document.getElementById('bmi-weight').value),h=parseFloat(document.getElementById('bmi-height').value)/100,bmi=(w/(h*h)).toFixed(2),cat=bmi<18.5?'Underweight':bmi<25?'Normal':bmi<30?'Overweight':'Obese';document.getElementById('bmi-result').innerText=isNaN(bmi)?'Error':`${bmi} (${cat})`;};
document.getElementById('calc-perc').onclick=()=>{const b=parseFloat(document.getElementById('perc-base').value),p=parseFloat(document.getElementById('perc-percent').value),r=(b*p/100).toFixed(2);document.getElementById('perc-result').innerText=isNaN(r)?'Error':r;};
(async()=>{const key='7b46c9d6348fe49e3acccd34';const res=await fetch(`https://v6.exchangerate-api.com/v6/${key}/latest/USD`);const data=await res.json();const rates=data.conversion_rates;const from=document.getElementById('curr-from'),to=document.getElementById('curr-to');Object.keys(rates).forEach(c=>{from.add(new Option(c,c));to.add(new Option(c,c));});document.getElementById('calc-curr').onclick=()=>{const a=parseFloat(document.getElementById('curr-amount').value),f=from.value,t=to.value;if(isNaN(a)){document.getElementById('curr-result').innerText='Error';return;}document.getElementById('curr-result').innerText=(a*rates[t]/rates[f]).toFixed(2);};})();
